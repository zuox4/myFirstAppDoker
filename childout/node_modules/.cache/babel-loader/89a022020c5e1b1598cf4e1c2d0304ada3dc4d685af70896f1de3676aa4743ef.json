{"ast":null,"code":"import React,{useContext,useEffect,useState}from'react';import CardOut from\"./CardOut\";import ChildCard from\"./ChildCard\";import axios from\"axios\";import{UserId}from\"../App\";import close from\"../assets/close.svg\";import moment from\"moment\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const History=()=>{const{user}=useContext(UserId);const[history,setHistory]=useState([]);const[filteredData,setFilteredData]=useState([]);const[data,setData]=useState('');function getHistoryOuts(){axios.get(`/get_history_user/${user.id}`).then(response=>{console.log(response);setHistory(response.data.history_list);const newArray=response.data.history_list.filter(elem=>{const date=new Date(elem.data_time_out);const day=new Date();console.log();return date.toLocaleDateString()===day.toLocaleDateString();});setFilteredData(newArray);});}useEffect(()=>{const data=moment().format('dddd');setData(data);getHistoryOuts();},[]);function getDate(date){const v=moment(date).toISOString().split('T')[1].split('.')[0];return v;}function deletePass(id){console.log(id);axios.post(`http://91.77.160.177:4001/delete_pass`,{pass_id:id}).then(response=>{console.log(response);alert(`Пропуск ${id} удален`);const newMass=filteredData.filter(elem=>elem.id!==id);setFilteredData(newMass);}).catch(e=>console.log(e));}return/*#__PURE__*/_jsxs(\"div\",{className:'card-out-list',style:{width:'100%',display:'flex',flexDirection:'column',alignItems:'center'},children:[/*#__PURE__*/_jsx(\"h1\",{style:{margin:0,fontSize:'25px',marginTop:'27px',fontWeight:'400'},children:\"\\u0418\\u0421\\u0422\\u041E\\u0420\\u0418\\u042F \\u0412\\u042B\\u0425\\u041E\\u0414\\u041E\\u0412\"}),/*#__PURE__*/_jsx(\"h1\",{style:{margin:0,fontSize:'25px',marginTop:'27px',fontWeight:'400'},children:data}),/*#__PURE__*/_jsx(\"div\",{style:{width:'200px',backgroundColor:'white',height:'2px',marginBottom:'10px',marginTop:'10px'}}),filteredData.length===0?/*#__PURE__*/_jsx(\"h1\",{style:{color:'#aaaaaa3d'},children:\"\\u0418\\u0441\\u0442\\u043E\\u0440\\u0438\\u044F \\u043F\\u0443\\u0441\\u0442\\u0430\"}):filteredData.map(el=>/*#__PURE__*/_jsxs(\"div\",{className:'childCard',style:{gridTemplateColumns:'3fr 1fr 1fr',alignItems:'center'},children:[/*#__PURE__*/_jsx(\"div\",{className:\"childName\",style:{marginLeft:'10px'},children:el.student_name}),/*#__PURE__*/_jsx(\"div\",{className:\"date-time\",style:{marginLeft:'10px'},children:getDate(el.data_time_out)}),/*#__PURE__*/_jsx(\"div\",{style:{},children:/*#__PURE__*/_jsx(\"img\",{src:close,onClick:()=>deletePass(el.id),style:{width:'20px'}})})]},el.id))]});};export default History;","map":{"version":3,"names":["React","useContext","useEffect","useState","CardOut","ChildCard","axios","UserId","close","moment","jsx","_jsx","jsxs","_jsxs","History","user","history","setHistory","filteredData","setFilteredData","data","setData","getHistoryOuts","get","id","then","response","console","log","history_list","newArray","filter","elem","date","Date","data_time_out","day","toLocaleDateString","format","getDate","v","toISOString","split","deletePass","post","pass_id","alert","newMass","catch","e","className","style","width","display","flexDirection","alignItems","children","margin","fontSize","marginTop","fontWeight","backgroundColor","height","marginBottom","length","color","map","el","gridTemplateColumns","marginLeft","student_name","src","onClick"],"sources":["C:/Users/kir/WebstormProjects/childout/src/components/History.jsx"],"sourcesContent":["import React, {useContext, useEffect, useState} from 'react';\r\nimport CardOut from \"./CardOut\";\r\nimport ChildCard from \"./ChildCard\";\r\nimport axios from \"axios\";\r\nimport {UserId} from \"../App\";\r\n\r\nimport close from \"../assets/close.svg\";\r\nimport moment from \"moment\";\r\n\r\nconst History = () => {\r\n    const { user } = useContext(UserId);\r\n    const [history, setHistory] = useState([]);\r\n    const [filteredData, setFilteredData] = useState([]);\r\n    const [data,setData] = useState('');\r\n    function getHistoryOuts(){\r\n        axios.get(`/get_history_user/${user.id}`).then((response) => {\r\n            console.log(response);\r\n            setHistory(response.data.history_list);\r\n\r\n            const newArray = response.data.history_list.filter(elem=>{\r\n                const date = new Date(elem.data_time_out)\r\n                const day = new Date()\r\n                console.log()\r\n                return date.toLocaleDateString()===day.toLocaleDateString()\r\n            })\r\n            setFilteredData(newArray)\r\n        })\r\n    }\r\n\r\n    useEffect(() => {\r\n        const data = moment().format('dddd');\r\n        setData(data)\r\n        getHistoryOuts()\r\n    }, []);\r\n    function getDate(date){\r\n        const v = moment(date).toISOString().split('T')[1].split('.')[0];\r\n        return v}\r\n    function deletePass(id){\r\n        console.log(id);\r\n        axios.post(`http://91.77.160.177:4001/delete_pass`, {pass_id:id}).then((response) => {\r\n            console.log(response)\r\n            alert(`Пропуск ${id} удален`)\r\n            const newMass = filteredData.filter(elem=>elem.id !== id)\r\n            setFilteredData(newMass);\r\n        }).catch(e=>console.log(e));\r\n    }\r\n    return (\r\n        <div className={'card-out-list'}\r\n             style={{width: '100%', display: 'flex', flexDirection: 'column', alignItems: 'center'}}>\r\n            <h1 style={{margin: 0, fontSize: '25px', marginTop: '27px', fontWeight: '400'}}>ИСТОРИЯ ВЫХОДОВ</h1>\r\n            <h1 style={{margin: 0, fontSize: '25px', marginTop: '27px', fontWeight: '400'}}>{data}</h1>\r\n            <div style={{\r\n                width: '200px',\r\n                backgroundColor: 'white',\r\n                height: '2px',\r\n                marginBottom: '10px',\r\n                marginTop: '10px'\r\n            }}></div>\r\n            {filteredData.length===0?<h1 style={{color:'#aaaaaa3d'}}>История пуста</h1>:filteredData.map(el => <div className={'childCard'} key={el.id}\r\n                                         style={{gridTemplateColumns: '3fr 1fr 1fr', alignItems: 'center'}}>\r\n                <div className=\"childName\" style={{marginLeft: '10px'}}>{el.student_name}</div>\r\n                <div className=\"date-time\" style={{marginLeft: '10px'}}>{getDate(el.data_time_out)}</div>\r\n                <div style={{}}>\r\n                    <img src={close} onClick={() => deletePass(el.id)} style={{width: '20px'}}/>\r\n                </div>\r\n\r\n            </div>)}\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default History;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}